<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Mitzvah Riding</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Mitzvah Riding">
  <meta name="theme-color" content="#1c1c1e">
  <link rel="apple-touch-icon" href="app-icon.png">
  <link rel="icon" type="image/png" href="app-icon.png">
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <div id="intro-screen">
    <div class="intro-text">
      <svg class="logo logo-large intro-logo" viewBox="0 0 100 100" fill="none">
        <circle cx="50" cy="50" r="45" stroke="url(#g1)" stroke-width="2" fill="none"/>
        <path d="M25 70 L35 30 L50 55 L65 30 L75 70" stroke="url(#g1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        <defs><linearGradient id="g1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#e8b4bc"/><stop offset="100%" style="stop-color:#d4a5a5"/></linearGradient></defs>
      </svg>
      <div class="intro-welcome">Welcome to</div>
      <h1 class="intro-title"><span>Mitzvah Riding</span></h1>
    </div>
  </div>

  <div class="app" id="app">

    <div class="page" id="page-landing">
      <div class="brand">
        <svg class="logo" viewBox="0 0 100 100" fill="none">
          <circle cx="50" cy="50" r="45" stroke="url(#g2)" stroke-width="2" fill="none"/>
          <path d="M25 70 L35 30 L50 55 L65 30 L75 70" stroke="url(#g2)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          <defs><linearGradient id="g2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#e8b4bc"/><stop offset="100%" style="stop-color:#d4a5a5"/></linearGradient></defs>
        </svg>
        <h1 class="brand-name"><span>Mitzvah Riding</span></h1>
        <p class="brand-tagline">Coordinate carpools for your celebration</p>
      </div>
      <div class="btn-group">
        <button class="btn btn-primary" onclick="showPage('page-signup-1')">Sign Up</button>
        <button class="btn btn-secondary" onclick="showPage('page-login')">Log In</button>
      </div>
    </div>

    <div class="page hidden" id="page-signup-1">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-landing')"><span class="back-arrow">‹</span> Back</button>
        <span class="step-indicator">Step 1 of 2</span>
      </div>
      <div class="form-header">
        <h2 class="form-title">Create Account</h2>
        <p class="form-subtitle">Let's start with the basics</p>
      </div>
      <div class="photo-upload">
        <div class="photo-preview" onclick="document.getElementById('photo-input').click()">
          <span class="photo-icon" id="photo-icon">Add<br>Photo</span>
          <img id="photo-preview-img" src="" alt="" style="display: none;">
        </div>
        <span class="photo-label">Profile Photo</span>
        <input type="file" id="photo-input" accept="image/*" onchange="handlePhotoUpload(event)">
      </div>
      <div class="form-group">
        <label class="form-label">Full Name</label>
        <input type="text" class="form-input" id="signup-name" placeholder="Enter your name">
        <div class="form-error" id="signup-name-error">Please enter your name</div>
      </div>
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" class="form-input" id="signup-email" placeholder="you@example.com">
        <div class="form-error" id="signup-email-error">Please enter a valid email address</div>
      </div>
      <button class="btn btn-primary" onclick="handleSignupStep1()">Continue</button>
      <div class="form-footer">
        <span class="form-footer-text">Already have an account? </span>
        <button class="btn-text" onclick="showPage('page-login')">Log In</button>
      </div>
    </div>

    <div class="page hidden" id="page-signup-2">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-signup-1')"><span class="back-arrow">‹</span> Back</button>
        <span class="step-indicator">Step 2 of 2</span>
      </div>
      <div class="form-header">
        <h2 class="form-title">Almost Done</h2>
        <p class="form-subtitle">Set up your contact and password</p>
      </div>
      <div class="form-group">
        <label class="form-label">Phone Number</label>
        <input type="tel" class="form-input" id="signup-phone" placeholder="(555) 123-4567">
        <div class="form-error" id="signup-phone-error">Please enter a valid phone number</div>
      </div>
      <div class="form-group">
        <label class="form-label">Password</label>
        <input type="password" class="form-input" id="signup-password" placeholder="Create a password">
        <div class="form-hint">Minimum 8 characters</div>
        <div class="form-error" id="signup-password-error">Password must be at least 8 characters</div>
      </div>
      <div class="form-group">
        <label class="form-label">Confirm Password</label>
        <input type="password" class="form-input" id="signup-confirm" placeholder="Confirm your password">
        <div class="form-error" id="signup-confirm-error">Passwords do not match</div>
      </div>
      <button class="btn btn-primary" id="signup-btn" onclick="handleSignupStep2()">Create Account</button>
    </div>

    <div class="page hidden" id="page-login">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-landing')"><span class="back-arrow">‹</span> Back</button>
        <span></span>
      </div>
      <div class="form-header">
        <h2 class="form-title">Welcome Back</h2>
        <p class="form-subtitle">Log in to your account</p>
      </div>
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" class="form-input" id="login-email" placeholder="you@example.com">
      </div>
      <div class="form-group">
        <label class="form-label">Password</label>
        <input type="password" class="form-input" id="login-password" placeholder="Enter your password">
        <div class="form-error" id="login-error">Invalid email or password</div>
      </div>
      <button class="btn btn-primary" id="login-btn" onclick="handleLogin()">Log In</button>
      <div class="form-footer">
        <span class="form-footer-text">Don't have an account? </span>
        <button class="btn-text" onclick="showPage('page-signup-1')">Sign Up</button>
      </div>
    </div>

    <div class="page with-nav hidden" id="page-home">
      <div class="page-header">
        <h1 class="page-header-title">Home</h1>
        <p class="page-header-subtitle" id="home-greeting"></p>
      </div>
      <div class="empty-state">
        <h3 class="empty-state-title">No Events Yet</h3>
        <p class="empty-state-text">You haven't been invited to any events yet.</p>
      </div>
    </div>

    <div class="page with-nav hidden" id="page-new">
      <div class="page-header">
        <h1 class="page-header-title">Create New</h1>
        <p class="page-header-subtitle">Start something new</p>
      </div>
      <div class="empty-state">
        <h3 class="empty-state-title">Coming Soon</h3>
        <p class="empty-state-text">Create new events and more.</p>
      </div>
    </div>

    <div class="page with-nav hidden" id="page-friends">
      <div class="page-header">
        <h1 class="page-header-title">Friends</h1>
        <p class="page-header-subtitle">Your connections</p>
      </div>
      <div class="empty-state">
        <h3 class="empty-state-title">No Friends Yet</h3>
        <p class="empty-state-text">Add friends to coordinate carpools together.</p>
      </div>
    </div>

    <div class="page with-nav hidden" id="page-dress">
      <div class="page-header">
        <h1 class="page-header-title">Dresses</h1>
        <p class="page-header-subtitle">Share and view outfits</p>
      </div>
      <div class="empty-state">
        <h3 class="empty-state-title">No Dresses Yet</h3>
        <p class="empty-state-text">Share your outfit so no one wears the same thing.</p>
      </div>
    </div>

    <div class="page with-nav hidden" id="page-profile">
      <div class="profile-card">
        <div class="profile-photo-large" id="profile-photo-large">
          <svg class="profile-placeholder-logo" viewBox="0 0 100 100" fill="none">
            <circle cx="50" cy="50" r="45" stroke="rgba(255,255,255,0.2)" stroke-width="2" fill="none"/>
            <path d="M25 70 L35 30 L50 55 L65 30 L75 70" stroke="rgba(255,255,255,0.2)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          </svg>
        </div>
        <h2 class="profile-name" id="profile-name">Name</h2>
        <p class="profile-username" id="profile-username">@username</p>
        <p class="profile-contact" id="profile-contact">email@example.com • (555) 123-4567</p>
      </div>

      <div class="profile-menu">
        <button class="menu-item" onclick="showPage('page-account-info')">
          <span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
          <span class="menu-text">Account Info</span>
          <span class="menu-arrow">›</span>
        </button>
        <button class="menu-item" onclick="showPage('page-settings')">
          <span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M12 1v2m0 18v2m11-11h-2M3 12H1m16.95 6.36l-1.41-1.41M6.46 6.46L5.05 5.05m12.9 0l-1.41 1.41M6.46 17.54l-1.41 1.41"/></svg></span>
          <span class="menu-text">Settings</span>
          <span class="menu-arrow">›</span>
        </button>
        <button class="menu-item" onclick="handleLogout()">
          <span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></span>
          <span class="menu-text">Log Out</span>
          <span class="menu-arrow">›</span>
        </button>
        <button class="menu-item menu-item-danger" onclick="showPage('page-delete-account')">
          <span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></span>
          <span class="menu-text">Delete Account</span>
          <span class="menu-arrow">›</span>
        </button>
      </div>
    </div>

    <!-- Account Info Page -->
    <div class="page hidden" id="page-account-info">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-profile')"><span class="back-arrow">‹</span> Back</button>
        <span></span>
      </div>
      <div class="form-header">
        <h2 class="form-title">Account Info</h2>
        <p class="form-subtitle">Enter password to view or edit</p>
      </div>
      
      <div id="account-info-locked">
        <div class="info-item">
          <span class="info-label">Name</span>
          <span class="info-value">••••••••</span>
        </div>
        <div class="info-item">
          <span class="info-label">Email</span>
          <span class="info-value">••••••••</span>
        </div>
        <div class="info-item">
          <span class="info-label">Phone</span>
          <span class="info-value">••••••••</span>
        </div>
        <div class="info-item">
          <span class="info-label">Password</span>
          <span class="info-value">••••••••</span>
        </div>
        
        <div class="form-group" style="margin-top: 24px;">
          <label class="form-label">Enter Password to Unlock</label>
          <input type="password" class="form-input" id="unlock-password" placeholder="Enter your password">
        </div>
        <button class="btn btn-primary" onclick="unlockAccountInfo()">Unlock</button>
      </div>
      
      <div id="account-info-unlocked" style="display: none;">
        <div class="photo-upload">
          <div class="photo-preview" onclick="document.getElementById('edit-photo-input').click()">
            <span class="photo-icon" id="edit-photo-icon">Add<br>Photo</span>
            <img id="edit-photo-preview-img" src="" alt="" style="display: none;">
          </div>
          <span class="photo-label">Tap to change photo</span>
          <input type="file" id="edit-photo-input" accept="image/*" onchange="handleEditPhotoUpload(event)">
        </div>
        
        <div class="form-group">
          <label class="form-label">Name</label>
          <input type="text" class="form-input" id="edit-name" placeholder="Enter your name">
          <div class="form-error" id="edit-name-error">This name is already taken</div>
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input type="email" class="form-input" id="edit-email" disabled style="opacity: 0.5;">
          <div class="form-hint">Email cannot be changed</div>
        </div>
        <div class="form-group">
          <label class="form-label">Phone</label>
          <input type="tel" class="form-input" id="edit-phone" placeholder="(555) 123-4567">
        </div>
        <div class="form-group">
          <label class="form-label">New Password</label>
          <input type="password" class="form-input" id="edit-new-password" placeholder="Leave blank to keep current">
          <div class="form-hint">Minimum 8 characters</div>
        </div>
        <button class="btn btn-primary" id="save-account-btn" onclick="saveAccountInfo()">Save Changes</button>
      </div>
    </div>

    <!-- Settings Page -->
    <div class="page hidden" id="page-settings">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-profile')"><span class="back-arrow">‹</span> Back</button>
        <span></span>
      </div>
      <div class="form-header">
        <h2 class="form-title">Settings</h2>
      </div>
      
      <div class="settings-section">
        <h3 class="settings-section-title">Appearance</h3>
        <div class="setting-item">
          <span class="setting-label">Dark Mode</span>
          <label class="toggle">
            <input type="checkbox" id="setting-dark-mode" checked onchange="toggleDarkMode(this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
      
      <div class="settings-section">
        <h3 class="settings-section-title">Notifications</h3>
        <div class="setting-item">
          <span class="setting-label">Event Reminders</span>
          <label class="toggle">
            <input type="checkbox" id="setting-event-reminders" checked onchange="saveSetting('eventReminders', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <span class="setting-label">Friend Requests</span>
          <label class="toggle">
            <input type="checkbox" id="setting-friend-requests" checked onchange="saveSetting('friendRequests', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <span class="setting-label">Carpool Updates</span>
          <label class="toggle">
            <input type="checkbox" id="setting-carpool-updates" checked onchange="saveSetting('carpoolUpdates', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
      
      <div class="settings-section">
        <h3 class="settings-section-title">Privacy</h3>
        <div class="setting-item">
          <span class="setting-label">Show Phone to Friends</span>
          <label class="toggle">
            <input type="checkbox" id="setting-show-phone" checked onchange="saveSetting('showPhone', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <span class="setting-label">Allow Friend Requests</span>
          <label class="toggle">
            <input type="checkbox" id="setting-allow-requests" checked onchange="saveSetting('allowRequests', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Delete Account Page -->
    <div class="page hidden" id="page-delete-account">
      <div class="top-bar">
        <button class="back-btn" onclick="showPage('page-profile')"><span class="back-arrow">‹</span> Back</button>
        <span></span>
      </div>
      <div class="form-header" style="margin-top: 40px;">
        <svg style="width: 64px; height: 64px; margin: 0 auto 20px; display: block;" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="1.5">
          <circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
        <h2 class="form-title">Delete Account</h2>
        <p class="form-subtitle" style="margin-top: 12px;">This action cannot be undone. All your data will be permanently deleted.</p>
      </div>
      <div class="form-group" style="margin-top: 32px;">
        <label class="form-label">Enter your password to confirm</label>
        <input type="password" class="form-input" id="delete-password" placeholder="Enter password">
      </div>
      <button class="btn btn-danger" id="delete-account-btn" onclick="deleteAccount()">Delete My Account</button>
      <button class="btn btn-secondary" style="margin-top: 12px;" onclick="showPage('page-profile')">Cancel</button>
    </div>

  </div>

  <nav class="bottom-nav" id="bottom-nav">
    <button class="nav-item" data-page="page-new" onclick="navigateTo('page-new')">
      <svg class="nav-icon" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
      <span>New</span>
    </button>
    <button class="nav-item" data-page="page-friends" onclick="navigateTo('page-friends')">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
      <span>Friends</span>
    </button>
    <button class="nav-item nav-center active" data-page="page-home" onclick="navigateTo('page-home')">
      <div class="nav-icon-wrap">
        <svg class="nav-icon" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
      </div>
      <span>Home</span>
    </button>
    <button class="nav-item" data-page="page-dress" onclick="navigateTo('page-dress')">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M6 2L3 8l3 2v12h12V10l3-2-3-6"></path><path d="M12 2v6"></path></svg>
      <span>Dress</span>
    </button>
    <button class="nav-item" data-page="page-profile" onclick="navigateTo('page-profile')">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
      <span>Profile</span>
    </button>
  </nav>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
